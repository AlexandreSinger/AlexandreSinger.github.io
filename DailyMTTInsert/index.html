<!DOCTYPE html>
<html>
<head>
    <title>Daily MTT Insert</title>
</head>
<body onload="onLoad();">
    <h1>Daily MTT Insert</h1>
    <button onclick="toggleB2();"><div id="toggle">Toggle to B2B</div></button>
    <form id="form" onsubmit="return false;">
        <div id="B2C" style="display: block;">
            <h2>B2C</h2>
            <button onclick="autoPopulateB2C();">Auto Populate</button><br>
            <label for="dayOfYear">Day of Year:</label><br>
            <input type="text" id="dayOfYear" name="dayOfYear"><br>
            <label for="title">Title:</label><br>
            <input type="text" id="title" name="title" size="35"><br>
            <label for="description">Description:</label><br>
            <textarea id="description" name="description" rows="4" cols="50"></textarea> <br>
            <label for="imgFileName">Image File Name:</label><br>
            <input type="text" id="imgFileName" name="imgFileName" size="35"><br>
            <button onclick="showImage();">Show Image</button>
            <!-- <div id="image" style="max-width: 1200;"></div> -->
            <br>
            <label for="seasonal_zone">Seasonal Zone:</label>
            <input type="text" id="seasonal_zone" name="seasonal_zone" value="0"><br>
            <br>
            <div id="goals">
                Goals:<br>
            </div>
            <br>
            <div id="situations">
                Situations:<br>
            </div>
        </div>
        <div id="B2B" style="display: none;">
            <h2>B2B</h2>
            <button onclick="autoPopulateB2B();">Auto Populate</button><br>
            <label for="postable_id">Postable ID:</label><br>
            <input type="text" id="postable_id" name="postable_id"><br>
            <label for="postable_type">Postable Type:</label><br>
            <input type="text" id="postable_type" name="postable_type"><br>
            <label for="postable_title">Postable Title:</label><br>
            <input type="text" id="postable_title" name="postable_title" size="35"><br>
            <label for="postable_description">Postable Description:</label><br>
            <textarea id="postable_description" name="postable_description" rows="4" cols="50"></textarea> <br>
            <label for="postable_url">Postable URL:</label><br>
            <input type="text" id="postable_url" name="postable_url" size="50"><br>
            <label for="postable_image">Postable Image:</label><br>
            <input type="text" id="postable_image" name="postable_image" size="35"><br>
            <button onclick="showImage();">Show Image</button>
            <!-- <div id="image_B2B" style="max-width: 1200;"></div> -->
            <br>
            <label for="seasonal_zone_B2B">Seasonal Zone:</label>
            <input type="text" id="seasonal_zone_B2B" name="seasonal_zone_B2B" value="0"><br>
            <br>
            <div id="B2B_goals">
                Goals:<br>
            </div>
        </div>
        <br>
        <button onclick="onSubmit();">Generate SQL Statements</button>
        <br>
        <br>
        <div id="SQL"></div>
        <button onclick="copySQL();">Copy SQL to Clipboard</button>
        <br>
        <br>
        <div id="image" style="max-width: 1200; display: block;"></div>
        <div id="image_B2B" style="max-width: 1200; display:none;"></div>
    </form>

    <script type="text/javascript">
        var goals = [
            "safe",
            "fuel_econ",
            "prev_maint",
            "acc_tires",
            "appear",
            "rust",
            "value",
            "comf_conv",
            "money",
            "allergy",
            "locks_security_car",
            "locks_security_home"
        ];

        var situations = [
            "sedan",
            "minivan",
            "suv",
            "convertible",
            "light_truck",
            "any_passenger_car",
            "high_profile_vehicle",
            "gas",
            "diesel",
            "hybrid",
            "electric",
            "gas_or_diesel",
            "hybrid_or_electric",
            "new_vehicle",
            "middle_aged",
            "old_vehicle",
            "new_or_middle_aged",
            "middle_or_old_aged",
            "low_mileage",
            "mid_mileage",
            "high_mileage",
            "low_or_mid_mileage",
            "mid_or_high_mileage",
            "low_miles_yearly",
            "med_miles_yearly",
            "high_miles_yearly",
            "low_or_med_yearly",
            "med_or_high_yearly",
            "low_highway",
            "med_highway",
            "high_highway",
            "low_or_med_highway",
            "med_or_high_highway",
            "rarely_off_road",
            "med_off_road",
            "high_off_road",
            "any_off_road",
            "rarely_or_med_off_road",
            "med_or_high_off_road",
            "rarely_trailer",
            "med_trailer",
            "high_trailer",
            "any_trailer",
            "rarely_or_med_trailer",
            "med_or_high_trailer",
            "teen_driver",
            "senior_driver",
            "new_driver",
            "phys_challenged",
            "teen_or_new_driver",
            "garaged_days",
            "garaged_eves",
            "not_garaged_days",
            "not_garaged_eves",
            "luggage_rack",
            "bike_carrier",
            "pets",
            "children",
            "infants",
            "hard_driving_situations",
            "children_or_infants"
        ];

        var B2B_goals = [
            "news_regulatory",
            "news_legislative",
            "news_technology",
            "news_economics",
            "new_business_owners",
            "inspirational_messages",
            "human_resources",
            "finance",
            "public_relations",
            "risk_management",
            "marketing",
            "strategic_planning",
            "information_technology",
            "customer_service",
            "supply_chain",
            "general_automotive",
            "automotive_humor"
        ];

        const goalsDiv = document.getElementById("goals");
        const B2BGoalsDiv = document.getElementById("B2B_goals");
        const situationsDiv = document.getElementById("situations");
        const SQLDiv = document.getElementById("SQL");

        function onLoad() {
            for (var i = 0; i < goals.length; i++) {
                goalsDiv.innerHTML += '<input type="checkbox" id="' + goals[i] + '" name="' + goals[i] + '">';
                goalsDiv.innerHTML += '<label for="' + goals[i]+'">' + goals[i] + '</label><br>'
            }
            for (var i = 0; i < situations.length; i++) {
                situationsDiv.innerHTML += '<input type="checkbox" id="' + situations[i] + '" name="' + situations[i] + '">';
                situationsDiv.innerHTML += '<label for="' + situations[i]+'">' + situations[i] + '</label><br>'
            }

            for (var i = 0; i < B2B_goals.length; i++) {
                B2BGoalsDiv.innerHTML += '<input type="checkbox" id="' + B2B_goals[i] + '" name="' + B2B_goals[i] + '">';
                B2BGoalsDiv.innerHTML += '<label for="' + B2B_goals[i]+'">' + B2B_goals[i] + '</label><br>'
            }
        }

        function toggleB2() {
            const B2CDiv = document.getElementById("B2C");
            const B2BDiv = document.getElementById("B2B");
            const toggleText = document.getElementById("toggle");
            if (B2CDiv.style.display === "none") {
                B2CDiv.style.display = "block";
                document.getElementById("image").style.display = "block";
                B2BDiv.style.display = "none";
                document.getElementById("image_B2B").style.display = "none";
                toggleText.innerHTML = "Toggle to B2B";
            } else {
                B2CDiv.style.display = "none";
                document.getElementById("image").style.display = "none";
                B2BDiv.style.display = "block";
                document.getElementById("image_B2B").style.display = "block";
                toggleText.innerHTML = "Toggle to B2C";
            }
            SQLDiv.innerHTML = "";
        }

        function showImage() {
            var imgDiv;
            var imgFile1;
            var imgFile2;
            if (document.getElementById("B2C").style.display === "none") {
                imgDiv = document.getElementById("image_B2B");
                imgFile1 = "https://applica-solutions.com/images/car-wizard-postables-assn/" + document.getElementById("form").elements['postable_image'].value;
                imgFile2 = "https://car-wizard.com/images/car-wizard-postables-assn/" + document.getElementById("form").elements['postable_image'].value;
            } else {
                imgDiv = document.getElementById("image");
                imgFile1 = "https://applica-solutions.com/images/car-wizard-postables/" + document.getElementById("form").elements['imgFileName'].value;
                imgFile2 = "https://car-wizard.com/images/car-wizard-postables/" + document.getElementById("form").elements['imgFileName'].value;
            }
            imgDiv.innerHTML = '<div style="float: left;">' + imgFile1 + ':<br><img src="' + imgFile1 +'" width=600></div>';
            imgDiv.innerHTML += '<div style="float: left;">' + imgFile2 + ':<br><img src="' + imgFile2 +'" width=600></div>';
        }

        function generateSQLB2C() {
            const form = document.getElementById("form");
            const dayOfYear = form.elements['dayOfYear'].value;
            const title = form.elements['title'].value;
            const description = form.elements['description'].value;
            const imgFileName = form.elements['imgFileName'].value;
            
            // Postables from DB Query string
            var insertCarWizardPostable = "INSERT INTO [homewizard_test2user].[CarWizard_Postables]([dayofyear],[image] ,[title] ,[description],[image_width] ,[image_height]) VALUES (";
            insertCarWizardPostable += dayOfYear + ",'";
            insertCarWizardPostable += "/images/car-wizard-postables/" + imgFileName + "','";
            insertCarWizardPostable += title + "','";
            insertCarWizardPostable += description.replace(/'/g, "''") + "',1200,628)";

            SQLDiv.innerHTML += insertCarWizardPostable + "<br>";

            // GS Seasonal Zones
            var seasonalZones = "INSERT INTO [homewizard_test2user].[Data_MTT_GS] ([mtt_id], [type], [gs_id]) values (" + dayOfYear + ",'seasonal_zone','" + form.elements['seasonal_zone'].value + "')"
            SQLDiv.innerHTML += seasonalZones + "<br>";

            // GS Goals
            for (var i = 0; i < goals.length; i++) {
                if (form.elements[goals[i]].checked) {
                    var goalSQL = "INSERT INTO [homewizard_test2user].[Data_MTT_GS] ([mtt_id], [type], [gs_id]) values (" + dayOfYear + ",'goal','" + goals[i] + "')";
                    SQLDiv.innerHTML += goalSQL + "<br>";
                }
            }
            // GS Situations
            for (var i = 0; i < situations.length; i++) {
                if (form.elements[situations[i]].checked) {
                    var situationSQL = "INSERT INTO [homewizard_test2user].[Data_MTT_GS] ([mtt_id], [type], [gs_id]) values (" + dayOfYear + ",'situation','" + situations[i] + "')";
                    SQLDiv.innerHTML += situationSQL + "<br>";
                }
            }
        }

        function generateSQLB2B() {
            const form = document.getElementById("form");
            const postable_id = form.elements['postable_id'].value;
            const postable_type = form.elements['postable_type'].value;
            const postable_title = form.elements['postable_title'].value;
            const postable_description = form.elements['postable_description'].value;
            var postable_url = form.elements['postable_url'].value;
            const postable_image = form.elements['postable_image'].value;
            
            // Insert into postables
            var insertCarWizardPostable = "INSERT INTO [homewizard_test2user].[CarWizard_Postables_Assn]([postable_type] ,[postable_title] ,[postable_description], [postable_url], [postable_image],[image_width] ,[image_height]) VALUES ('";
            insertCarWizardPostable += postable_type + "','";
            insertCarWizardPostable += postable_title + "','";
            insertCarWizardPostable += postable_description.replace(/'/g, "''") + "','";
            insertCarWizardPostable += postable_url + "','"
            insertCarWizardPostable += "/images/car-wizard-postables-assn/" + postable_image + "',1200,628)";

            SQLDiv.innerHTML += insertCarWizardPostable + "<br>";

            // Insert seasonal zone
            var seasonalZones = "INSERT INTO [homewizard_test2user].[Data_MTT_GS_Assn] ([mtt_id], [type], [gs_id]) values (" + postable_id + ",'seasonal_zone','" + form.elements['seasonal_zone_B2B'].value + "')"
            SQLDiv.innerHTML += seasonalZones + "<br>";

            // Insert goals
            for (var i = 0; i < B2B_goals.length; i++) {
                if (form.elements[B2B_goals[i]].checked) {
                    var goalSQL = "INSERT INTO [homewizard_test2user].[Data_MTT_GS_Assn] ([mtt_id], [type], [gs_id]) values (" + postable_id + ",'goal','" + B2B_goals[i] + "')";
                    SQLDiv.innerHTML += goalSQL + "<br>";
                }
            }
        }

        function autoPopulateB2C() {
            navigator.clipboard.readText()
                .then(text => {
                    var splittedText = text.split('\t');
                    form.elements['dayOfYear'].value = splittedText[0];
                    form.elements['title'].value = splittedText[1];
                    form.elements['description'].value = splittedText[2];
                    form.elements['imgFileName'].value = splittedText[3];
                    showImage();
                })
                .catch(err => {
                    console.error('Failed to read clipboard contents: ', err);
                });
        }

        function copySQL() {
            navigator.clipboard.writeText(SQLDiv.innerText)
                .then(() => {
                    console.log(SQLDiv.innerText);
                })
                .catch(err => {
                    // This can happen if the user denies clipboard permissions:
                    console.error('Could not copy text: ', err);
                });
        }

        function autoPopulateB2B() {
            navigator.clipboard.readText()
                .then(text => {
                    var splittedText = text.split('\t');
                    form.elements['postable_id'].value = splittedText[0];
                    form.elements['postable_type'].value = splittedText[1];
                    form.elements['postable_title'].value = splittedText[2];
                    form.elements['postable_description'].value = splittedText[3];
                    form.elements['postable_image'].value = splittedText[4];
                    form.elements['postable_url'].value = splittedText[5];
                    showImage();
                })
                .catch(err => {
                    console.error('Failed to read clipboard contents: ', err);
                });
        }

        function onSubmit() {
            SQLDiv.innerHTML = "";

            if (document.getElementById("B2C").style.display === "none") {
                generateSQLB2B();
            } else {
                generateSQLB2C();
            }
        }
    
    </script>
</body>
</html>